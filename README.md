# What is this?

放送大学の学部生向けの科目「心理統計法」の課題をPythonで自動的に回答できるようなプログラムです。
READMEに課題の結果の考察等を掲載しています。

## 使用技術 (Link to its Reference if needed)

- Python
  - Numpy, Pandas, [PyStan](https://pystan.readthedocs.io/en/latest/api.html) [(Stan)](https://stan-ja.github.io/gh-pages-html/), [Arviz](https://arviz-devs.github.io/arviz/api/index.html)

# データ
- 何も見ずに30秒が経った思ったところで止めた時の時間データ(30秒の知覚時間)
  - スマートフォンアプリのストップウォッチを使い、30秒だと思ったところでストップウォッチの停止を押す。これを20回繰り返す。
    - ストップウォッチの停止ミスは省いていることに注意。

```
[30.87 30.37 31.7  35.42 31.41 30.75 29.41 29.68 30.25 29.56 30.08 29.41
 30.05 30.49 30.61 29.04 30.03 30.35 30.8  29.86]
```

# 第一章
- 度数分布
```
29s ~ 30s : 6
30s ~ 31s : 11
31s ~ 32s : 2
32s ~ 33s : 0
33s ~ 34s : 0
34s ~ 35s : 0
35s ~ 36s : 1
```
![histgram](https://github.com/konabe/openUnivPsyStat/blob/master/img/Figure_1.png?raw=true)

- 最頻値 => 30s ~ 31s
- 平均: 30.51
- 分散: 1.7
- 標準偏差: 1.3
- 中央値: 30.3
- 第一四分位数: 29.82
- 第三四分位数: 30.76
- 95%予測区間: 27.953344138768887 ~ 33.060655861231105

ヒストグラムからわかるように、35.42という外れ値が存在するが、平均と中央値の差はそこまで激しくない。
サンプル数が十分であるためか、平均が外れ値の影響をあまり受けていないことがわかる。

# 第三章
- Stanの実行結果
  - [モデル](https://github.com/konabe/openUnivPsyStat/blob/master/model.stan)はデータ生成分布に正規分布を仮定
```
         mean se_mean     sd   2.5%     5%    50%    95%  97.5%  n_eff   Rhat
theta    30.5  6.2e-3   0.32  29.86  29.97  30.49  31.03  31.14   2686    1.0
sigma    1.43  5.2e-3   0.26   1.03   1.08    1.4    1.9   2.01   2389    1.0
X_pred  30.51    0.03   1.49  27.48   28.1  30.51  32.98  33.51   3388    1.0
lp__   -16.06    0.03   1.05 -18.87 -18.11 -15.74 -15.08 -15.04   1430    1.0
```
![result](https://github.com/konabe/openUnivPsyStat/blob/master/img/Figure_2.png?raw=true)

thetaは正規分布の平均、sigmaは正規分布の標準偏差、X_predは予測分布に対応。

## MCMCの結果の妥当性確認
- トレースプロットを見る限り、全てのチェインが重なっており、ドリフトなどは起こっていないため収束はしっかりできていると判断できる
- 収束判定値Rhatが1.1以下であるため問題無し。
- 有効標本数n_effによれば、3000くらいの独立した乱数とみなせるとわかる。

## 課題
### 3-1 平均値の点推定

点推定値は、平均だと30.5、メジアンだと30.49となる。
僕の30秒の知覚時間の平均は30.5の周りでばらついていると言える。

### 3-2 平均値の両側区間推定

α=5%としたとき、両側確信区間は29.86 ~ 31.14である。平均は95%の確率で29.86 ~ 31.14の中にあるといえる。

### 3-3 平均値の片側区間推定

α=5%としたとき、片側革新区間は~31.03である。平均は95%の確率で31.03を超えないといえる。

### 3-4 標準偏差の点推定、区間推定

標準偏差は点推定値が1.43で、片側区間推定によれば95%の確率で1.9を超えない。

### 3-5 予測区間

僕のこれからの30秒の知覚時間は、95%の確率で27.48 ~ 33.51に入ると予測された。
標本中でも同じような確率で33.51を超えていることも意味があるのか？

# 第四章
## 課題
### 4-1 (RQ6)
